<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Recursive Veins</title>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/p5.js/1.9.0/p5.min.js"></script>
  <style>
    body { margin: 0; overflow: hidden; background: #0a0a0f; }
    canvas { display: block; }
  </style>
</head>
<body>
<script>
// Recursive Veins - Self-similar branching patterns
let branches = [];
let maxDepth = 7;
let hueOffset = 0;

function setup() {
  createCanvas(windowWidth, windowHeight);
  colorMode(HSB, 360, 100, 100, 100);
  noLoop();
  
  // Initialize root branch
  branches.push(new Branch(width/2, height, -PI/2, height * 0.35, 0));
}

function draw() {
  background(10, 20, 8);
  
  // Draw all branches
  for (let b of branches) {
    b.show();
  }
  
  // Subtle glow overlay
  noStroke();
  for (let i = 0; i < 5; i++) {
    fill(280, 60, 20, 3);
    rect(0, 0, width, height);
  }
}

class Branch {
  constructor(x, y, angle, len, depth) {
    this.x = x;
    this.y = y;
    this.angle = angle;
    this.len = len;
    this.depth = depth;
    this.complete = false;
    
    if (depth < maxDepth) {
      this.spawnChildren();
    } else {
      this.complete = true;
    }
  }
  
  spawnChildren() {
    let numChildren = floor(random(2, 4));
    let spread = random(0.3, 0.7);
    
    for (let i = 0; i < numChildren; i++) {
      let newAngle = this.angle + random(-spread, spread);
      let newLen = this.len * random(0.6, 0.8);
      let newX = this.x + cos(newAngle) * this.len;
      let newY = this.y + sin(newAngle) * this.len;
      
      branches.push(new Branch(newX, newY, newAngle, newLen, this.depth + 1));
    }
    this.complete = true;
  }
  
  show() {
    let hue = (this.depth * 40 + hueOffset) % 360;
    let brightness = map(this.depth, 0, maxDepth, 90, 50);
    let thickness = map(this.depth, 0, maxDepth, 8, 1);
    
    stroke(hue, 70, brightness, 80);
    strokeWeight(thickness);
    line(this.x, this.y, 
         this.x + cos(this.angle) * this.len, 
         this.y + sin(this.angle) * this.len);
    
    // End nodes glow
    if (this.depth >= maxDepth - 1) {
      noStroke();
      let endX = this.x + cos(this.angle) * this.len;
      let endY = this.y + sin(this.angle) * this.len;
      fill(hue, 50, 100, 60);
      circle(endX, endY, thickness * 4);
    }
  }
}

function mousePressed() {
  // Regenerate on click
  branches = [];
  hueOffset = random(360);
  branches.push(new Branch(width/2, height, -PI/2, height * 0.35, 0));
  redraw();
}

function windowResized() {
  resizeCanvas(windowWidth, windowHeight);
  branches = [];
  branches.push(new Branch(width/2, height, -PI/2, height * 0.35, 0));
  redraw();
}
</script>
</body>
</html>
