<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Chladni Patterns</title>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/p5.js/1.9.0/p5.min.js"></script>
  <style>
    * { margin: 0; padding: 0; box-sizing: border-box; }
    body { overflow: hidden; background: #0a0a0f; }
    canvas { display: block; }
  </style>
</head>
<body>
<script>
// Chladni Patterns - Vibrating plate visualization
// Patterns emerge from standing wave interference

let time = 0;
let n1 = 3, n2 = 7; // Mode numbers
let modeChangeTimer = 0;

function setup() {
  createCanvas(windowWidth, windowHeight);
  pixelDensity(1);
  colorMode(HSB, 360, 100, 100, 1);
}

function windowResized() {
  resizeCanvas(windowWidth, windowHeight);
}

function draw() {
  background(0, 0, 5);
  
  let cx = width / 2;
  let cy = height / 2;
  let size = min(width, height) * 0.85;
  
  // Auto-change modes over time
  modeChangeTimer++;
  if (modeChangeTimer > 300) {
    modeChangeTimer = 0;
    n1 = floor(random(1, 8));
    n2 = floor(random(1, 12));
  }
  
  // Draw Chladni pattern
  loadPixels();
  
  for (let x = 0; x < width; x += 2) {
    for (let y = 0; y < height; y += 2) {
      let px = (x - cx) / size * 2;
      let py = (y - cy) / size * 2;
      
      // Chladni formula: cos(n1*pi*x) * cos(n2*pi*y) - cos(n2*pi*x) * cos(n1*pi*y)
      let val = cos(n1 * PI * px) * cos(n2 * PI * py) - 
                cos(n2 * PI * px) * cos(n1 * PI * py);
      
      val = sin(time * 0.02) * 0.5 + 0.5 + val * 0.3;
      val = constrain(val, 0, 1);
      
      // Create intricate patterns
      let hue = (val * 180 + time * 0.5) % 360;
      let sat = val * 80;
      let bri = val * 100;
      
      // Threshold for pattern lines
      let lineVal = abs(sin(val * 40 + time * 0.03));
      if (lineVal < 0.15) {
        sat = 20;
        bri = 100;
      }
      
      // Draw with some overlap for smoothness
      for (let dx = 0; dx < 2 && x + dx < width; dx++) {
        for (let dy = 0; dy < 2 && y + dy < height; dy++) {
          let idx = 4 * ((y + dy) * width + (x + dx));
          let c = color(hue, sat, bri);
          pixels[idx] = red(c);
          pixels[idx + 1] = green(c);
          pixels[idx + 2] = blue(c);
          pixels[idx + 3] = 255;
        }
      }
    }
  }
  
  updatePixels();
  
  // Add glowing nodes at vibration antinodes
  noStroke();
  for (let i = 0; i < 20; i++) {
    let angle = i * TWO_PI / 20 + time * 0.01;
    let radius = size * 0.3 * sin(n1 * angle) * cos(n2 * angle + time * 0.02);
    let nx = cx + cos(angle + time * 0.01) * radius;
    let ny = cy + sin(angle + time * 0.01) * radius;
    
    let pulse = (sin(time * 0.05 + i) + 1) * 0.5;
    fill(200 + i * 5, 80, 100, 0.3 + pulse * 0.4);
    ellipse(nx, ny, 10 + pulse * 20);
  }
  
  // Mode indicator
  fill(255);
  textSize(12);
  textAlign(LEFT, TOP);
  text(`Mode: n1=${n1}, n2=${n2}`, 20, 20);
  
  time++;
}
</script>
</body>
</html>
